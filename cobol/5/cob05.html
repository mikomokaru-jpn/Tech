<!-- -->
<DOCTYPE HTML>
<html id="mainhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>処理パターン(４) 外部サブプログラム呼ぶ</title>
  <link rel="stylesheet" type="text/css" href="/lib/document.css">
</head>
<body id="mainbody">
<!-- ↓↓↓↓↓↓↓↓↓↓↓ -->
<script type="text/javascript" src="/lib/funcs5.js"></script>
<!-- ↑↑↑↑↑↑↑↑↑↑ -->
<div id="content">
<h2 class="lm70 tm20 bm0">
処理パターン(４) 外部サブプログラム呼ぶ
</h2>
<div class="lm70 tm5 rm60">
「処理パターン(３) テーブルの利用」におけるマスターファイルの読み込みをサブプログラムで行う。
</div>
<h3 class="lm70 tm10 bm0 rm60">
機能仕様
</h3>
<div class="lm70 tm5 rm60">
サブプログラムで顧客マスターファイルを読み込み、顧客マスターテーブルを作成する。メインプログラムはサブプログラムから顧客マスターテーブルを取得する。
</div>
<div class="lm70 tm10 rm60">
サブプログラムから戻り値を取得するには、メイン側で戻り値の領域を確保し、その参照を受け渡す方法をとる（いわゆる引数の参照渡し）。
</div>
<div class="lm70 tm10 rm60">
CALL GIVING により得られる戻り値は、サブルーチンが変数 RERURN-CODE に代入する値であり、これは数値のみしか扱えないので、一般的にはコンディションコードとして利用する。RERURN-CODE はシステムで宣言されたグローバル変数である。
</div>
<h3 class="lm70 tm20 bm0 rm60">
入出力構成図
</h3>
<!-- 画像 -->
<a href="/lib/HTMLofImage.html?filename=/cobol/5/cob05_01.png&title=cob05_01&width=500" target="_new">
<img class="lm70 tm10 bm0" src="cob05_01.png" alt="[cob05_01.png]" width="300"></a>
<h3 class="lm70 tm20 bm0 rm60">
ソースコード
</h3>
<div class="lm70 tm5 bm0 rm60"> 
<h3 class="inline">
メインプログラム&nbsp;
</h3>
<!--ソースコードリンク-->
<a href="/lib/HTMLofText.html?filename=/cobol/5/source/MAIN01.txt&title=MAIN01.cbl" target="_new">MAIN01.cbl</a>
</div>
<div class="lm70 tm5 rm60">
引数を指定してサブプログラムを呼び出す部分。サブプログラムが戻り値を設定する領域の参照渡を引数に指定する。
</div>
<!--ソースコード-->
<iframe class="lm70 tm5" src="/lib/HTMLofText.html?filename=/cobol/5/MAIN01_1.txt" width="580" height="250"></iframe>
<div class="lm70 tm20 bm0 rm60"> 
<h3 class="inline">
サブプログラム&nbsp;
</h3>
<!--ソースコードリンク-->
<a href="/lib/HTMLofText.html?filename=/cobol/5/source/SUB01.txt&title=SUB01.cbl" target="_new">SUB01.cbl</a>
</div>
<div class="lm70 tm5 bm0 rm60">
引数として受け取る領域は DATA DIVISION の LINKAGE SECTION に定義する。
</div>
<!--ソースコード-->
<iframe class="lm70 tm5" src="/lib/HTMLofText.html?filename=/cobol/5/SUB01_1.txt" width="580" height="150"></iframe>
<div class="lm70 tm20 bm0 rm60">
PROCEDURE DIVISION宣言にUSING句で引数名を指定する。    
</div>
<div class="lm70 tm5 bm0 rm60">
参照渡しで渡された引数の領域に値をセットすれば呼び出し側で参照することができる。呼び出し側に戻るときは GOBACK文を実行する。
</div>
<!--ソースコード-->
<iframe class="lm70 tm5" src="/lib/HTMLofText.html?filename=/cobol/5/SUB01_2.txt" width="580" height="520"></iframe>
<h3 class="lm70 tm30 bm0 rm60">
コンパイル・リンクの方法
</h3>
<h3 class="lm70 tm5 bm0 rm60">
静的リンク
</h3>
<div class="lm70 tm0 bm0 rm60">
一括してコンパイルする。
</div>
<!--ソースコード-->
<iframe class="lm70 tm5" src="/lib/HTMLofText.html?filename=/cobol/5/cobc01.txt" width="580" height="50"></iframe>
<div class="lm70 tm5 bm0 rm60">
サブプログラムを別にコンパイルする。
</div>
<!--ソースコード-->
<iframe class="lm70 tm5" src="/lib/HTMLofText.html?filename=/cobol/5/cobc02.txt" width="580" height="60"></iframe>
<h3 class="lm70 tm20 bm0 rm60">
動的（ダイナミック）リンク
</h3>
<!--ソースコード-->
<iframe class="lm70 tm5" src="/lib/HTMLofText.html?filename=/cobol/5/cobc03.txt" width="580" height="160"></iframe>
<div class="lm70 tm10 bm0 rm60">
共用オブジェクトを特定のフォルダにおく
</div>
<!--ソースコード-->
<iframe class="lm70 tm5" src="/lib/HTMLofText.html?filename=/cobol/5/cobc04.txt" width="580" height="90"></iframe>
<div class="lm70 tm20 bm0 rm60">
詳細はここを参照
</div>
<!--ソースコードリンク-->
<div class="lm70 tm5 rm60">
<a href="https://open-cobol.sourceforge.io/doc/gnucobol.html" target="_new">GnuCOBOL Manual</a>
</div>
<!-- 空白行 -->
<div class="bp40"></div>
<!----------------------------------------------->
</div><!-- end of content -->
<footer id="mainfooter">
<div class="tp10 bm10 bp10 textright"> <span class="rm500 font80"><a href="/lib/index5.html">メニューに戻る</a></span><span class="rm20 font80"><a href="#mainheader">TOPに戻る</a></span></div>
</footer>
<script type="text/javascript" src="/lib/access/access2.js"></script>
</body>
</html>
