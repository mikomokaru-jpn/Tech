//------------------------------------------------------------------------------//  UAView.swift//------------------------------------------------------------------------------import Cocoaclass UAView: NSView {    //必ず値が入っているから暗黙的アンラップ型にする。（変数はアンラップしないで使用できる）    @IBOutlet weak var rectangle: NSButton!    var shapeMng: UAShapeManager    /* xibファイルでオブジェクト化されている場合は呼ばれない    override init(frame: NSRect){        print(#function)        super.init(frame: frame)    }    */    required init?(coder aDecoder: NSCoder) {        shapeMng = UAShapeManager() //super.initの前に行うこと。初期化は下から上に遡上する。        super.init(coder: aDecoder)    }    override func awakeFromNib(){        self.wantsLayer = true        self.layer!.borderColor = NSColor.gray.cgColor        self.layer!.borderWidth = 1.0;        self.layer!.backgroundColor = NSColor.white.cgColor;        shapeMng.frameOfShape = self.bounds;    }    //ドラッグ開始    override func mouseDown(with event: NSEvent) {        let point:CGPoint = self.convert(event.locationInWindow, from: nil)        if rectangle.state ==  NSControl.StateValue.on{            //描画中            shapeMng.createStart(point)            self.addSubview(shapeMng.selectedItem)        }else{            //描画中以外            shapeMng.start(point)        }    }    //ドラッグ中    override func mouseDragged(with event: NSEvent) {        let point:CGPoint = self.convert(event.locationInWindow, from: nil)        if rectangle.state ==  NSControl.StateValue.on{            //描画中            shapeMng.createGoing(point)        }else{            //描画中以外            shapeMng.going(point)        }    }    //ドラッグ終了    override func mouseUp(with event: NSEvent) {        let point:CGPoint = self.convert(event.locationInWindow, from: nil)        if rectangle.state ==  NSControl.StateValue.on{            //描画中            shapeMng.createStop(point)            rectangle.state =  NSControl.StateValue.off        }else{            //描画中以外            shapeMng.stop(point)        }    }}