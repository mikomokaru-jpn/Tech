<!-- 
13 WindowControl
-->
<DOCTYPE HTML>
<html id="mainhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>メインウィンドウからサブウィンドウを開く</title>
	<link rel="stylesheet" type="text/css" href="/lib/document.css">
</head>
<body id="mainbody">
<!-- ↓↓↓↓↓↓↓↓↓↓↓ -->
<script type="text/javascript" src="/lib/funcs1.js"></script>
<!-- ↑↑↑↑↑↑↑↑↑↑ -->
<div id="content">
<h2 class="lm70 tm20 bm10">メインウィンドウからサブウィンドウを開く</h2>
<div class="lm100 tm5 rm60">
ウィンドウアプリケーションのメインウィンドウからサブウィンドウを開く場合、表示モードは、「モーダル」か「モードレス」のいずれかになる。
</div>
<div class="lm100 tm10 rm60">
モーダルなウィンドウは、サブウインドウを開くとイベントループ制御がメインウインドウからサブウインドウに移り、サブウィンドウを閉じるまでメインウインドウの操作ができなくなる。モーダルなウィンドウには、「シート」と、通常の「ウィンドウ」がある。。
</div>
<div class="lm100 tm10 rm60">
サンプルアプリケーションを元に、それぞれのウィンドウ制御の実装方法について説明する。
</div>
<!-- 画像 -->
<a href="/lib/HTMLofImage.html?filename=/data/03/03_open_subwindow.png&title=クラス構造図&width=850" target="_new">
<img class="lm100 tm15 bm0" src="03_open_subwindow.png" width="500" align="top" alt="クラス構造図" ></a>
<h3 class="lm100 tm10 rm60 bm0">
サンプルアプリケーションの仕組み
</h3>
<div class="lm100 tm0 rm60">
AppDelegateは、サブウィンドウを制御するウィンドウコントローラオブジェクトを作成し、保持することで全体を制御する。
メインウィンドウにサブウィンドウを開くボタンを定義し、ユーザーがボタンをクリックすると、対応するサブウィンドウが開くようにする。
</div>
<h3 class="lm100 tm20 rm60 bm0">
モーダルなシート
</h3>
<div class="lm100 tm0" style="width:550px; border-top:solid 1px #909090;"></div>
<div class="lm100 tm5 rm60">
「シート」は、ウインドウのタイトルバーの下から飛び出す小さなウィンドウのことである。例えば、アプリケーションの「テキストエディット」を起動し、「プリント」を選ぶと部数などを入力するシートが現れる。
</div>
<!-- 画像 -->
<a href="/lib/HTMLofImage.html?filename=/data/03/ModalSheet.png&title=モーダル・シート&width=700" target="_new">
<img class="lm160 tm10 bm0" src="ModalSheet.png" width="250" align="top" alt="モーダル・シート" ></a>
<h4 class="lm130 tm10 bm0 rm60">
ウィンドウコントローラクラスの定義と実装
</h4>
<!-- ソースコード -->
<iframe class="lm130 tm5 bm10" src="/lib/HTMLofText.html?filename=/data/03/WinCtrl1.txt" width="530" height="520"></iframe>
<h4 class="lm130 tm10 rm60 bm0">
初期化
</h4>
<div class="lm130 tm0 rm60">
AppDelegateはウィンドウコントローラーを作成し、自身のプロパティに保持する。初期化のときに指定されたxibファイルからウィンドウオブジェクト（シート）を読み込む。
</div>
<!-- ソースコード -->
<iframe class="lm130 tm5 bm10" src="/lib/HTMLofText.html?filename=/data/03/WinInit1.txt" width="530" height="110"></iframe>
<h4 class="lm130 tm10 rm60 bm0">
シートを開く
</h4>
<div class="lm130 tm0 rm60">
AppDelegateは、サブウィンドウ（シート）を引数として、メインウィンドウの beginSheetメソッドを呼ぶ。これによりシートが現れる。completionHandlerにシートを閉じたときのコールバック処理を記述する。
</div>
<!-- ソースコード -->
<iframe class="lm130 tm5 bm10" src="/lib/HTMLofText.html?filename=/data/03/beginSheet.txt" width="530" height="250"></iframe>
<h4 class="lm130 tm10 rm60 bm0">
シートを閉じる
</h4>
<div class="lm130 tm0 rm40">
ウィンドウコントローラの中から、メインウィンドウのendSheetメソッドを呼ぶ。
</div>
<!-- ソースコード -->
<iframe class="lm130 tm5 bm10" src="/lib/HTMLofText.html?filename=/data/03/endSheet.txt" width="530" height="100"></iframe>
<h3 class="lm100 tm30 rm40 bm0">
モーダルなウィンドウ
</h3>
<div class="lm100 tm0" style="width:550px; border-top:solid 1px #909090;"></div>
<!-- 画像 -->
<a href="/lib/HTMLofImage.html?filename=/data/03/ModalWindow.png&title=モーダル・ウィンドウ&width=700" target="_new">
<img class="lm160 tm10 bm0" src="ModalWindow.png" width="400" align="top" alt="モーダル・ウィンドウ" ></a>
<h4 class="lm130 tm10 bm0 rm60">
ウィンドウコントローラクラスの定義と実装
</h4>
<!-- ソースコード -->
<iframe class="lm130 tm5 bm10" src="/lib/HTMLofText.html?filename=/data/03/WinCtrl2.txt" width="530" height="640"></iframe>
<h4 class="lm130 tm10 rm60 bm0">
初期化
</h4>
<div class="lm130 tm0 rm60">
AppDelegateはウィンドウコントローラーを作成し、自身のプロパティに保持する。初期化のときに指定されたxibファイルからウィンドウオブジェクトを読み込む。
</div>
<!-- ソースコード -->
<iframe class="lm130 tm5 bm10" src="/lib/HTMLofText.html?filename=/data/03/WinInit2.txt" width="530" height="110"></iframe>

<h4 class="lm130 tm10 rm60 bm0">
ウィンドウを開く
</h4>
<div class="lm130 tm0 rm40">
AppDeelegateは サブウィンドウを引数に NSAppクラスのrunModalForWindowメソッドを呼ぶ。これによりイベントループ制御がサブウインドウに移る。
</div>
<!--ソースコード-->
<iframe class="lm130 tm5 bm10" src="/lib/HTMLofText.html?filename=/data/03/runModalForWindow.txt" width="530" height="150"></iframe>
<h4 class="lm130 tm10 rm60 bm0">
ウィンドウを閉じる
</h4>
<div class="lm130 tm0 rm40">
ウィンドウコントローラの中から、NSAppクラスのstopModalWithCodeメソッドを呼ぶ。これによりイベントループはメインウィンドウに戻る。および、サブウィンドウのcloseメソッドでウィンドウを閉じる。両メソッドの実行は順不同でよい。
</div>
<!-- ソースコード -->
<iframe class="lm130 tm5 bm0" src="/lib/HTMLofText.html?filename=/data/03/runModalForWindowClose.txt" width="530" height="110"></iframe>
<div class="lm130 tm10 rm40">
サブウィンドウを Xボタンで閉じたときに、イベントループをメインウィンドウに戻す必要がある。
</div>
<!-- ソースコード -->
<iframe class="lm130 tm5 bm10" src="/lib/HTMLofText.html?filename=/data/03/windowWillClose.txt" width="530" height="90"></iframe>

<h3 class="lm100 tm30 bm0 rm40">
モードレスなウインドウ
</h3>
<div class="lm100 tm0" style="width:550px; border-top:solid 1px #909090;"></div>
<!-- 画像 -->
<a href="/lib/HTMLofImage.html?filename=/data/03/ModelessWindow.png&title=モードレス・ウィンドウ&width=700" target="_new">
<img class="lm160 tm10 bm0" src="ModelessWindow.png" width="400" align="top" alt="モードレス・ウィンドウ" ></a>
<h4 class="lm130 tm10 bm0 rm60">
ウィンドウコントローラクラス
</h4>
<!-- ソースコード -->
<iframe class="lm130 tm5 bm10" src="/lib/HTMLofText.html?filename=/data/03/WinCtrl3.txt" width="530" height="540"></iframe>
<h4 class="lm130 tm10 rm60 bm0">
初期化
</h4>
<div class="lm130 tm0 rm60">
AppDelegateはウィンドウコントローラーを作成し、自身のプロパティに保持する。初期化のときに指定されたxibファイルからウィンドウオブジェクトを読み込む。
</div>
<!-- ソースコード -->
<iframe class="lm130 tm5 bm10" src="/lib/HTMLofText.html?filename=/data/03/WinInit3.txt" width="530" height="110"></iframe>
<h4 class="lm130 tm10 rm60 bm0">
ウィンドウを開く
</h4>
<div class="lm130 tm0 rm60">
AppDelegateはウィンドウコントローラの showWindowメソッドを呼ぶ。イベントループ制御は、フォーカスの移動により、メインウィンドウとサブウィンドウの間で切り替えることができる。モードレスなウィンドウは表示位置を指定することができる。
</div>
<!--ソースコード-->
<iframe class="lm130 tm5 bm10" src="/lib/HTMLofText.html?filename=/data/03/showWindow.txt" width="530" height="180"></iframe>
<h4 class="lm130 tm10 rm60 bm0">
ウィンドウを閉じる
</h4>
<div class="lm130 tm0 rm40">
ウィンドウコントローラから自ウィンドウのcloseメソッドを呼ぶ。
</div>
<!-- ソースコード -->
<iframe class="lm130 tm5 bm10" src="/lib/HTMLofText.html?filename=/data/03/showWindowClose.txt" width="530" height="100"></iframe>
<h4 class="lm100 tm20 bm0 rm40">
Interface Builderの設定（忘れやすいのでメモしておく）
</h4>
<div class="lm100 tm0" style="width:520px; border-top:solid 1px #909090;"></div>
<div class="lm130 tm5 rm40">
サブウィンドウのFiles Ownerは、ウィンドウコントローラクラスとする。ウィンドウコントローラのWindowプロパティは、サブウィンドウに対してOutlet接続しておく。
</div>
<!-- 画像 -->
<a href="/lib/HTMLofImage.html?filename=/data/03/subWindowXib.png&title=Interface Builder&width=800" target="_new">
<img class="lm130 tm10 bm0" src="subWindowXib.png" width="400" align="top" alt="Interface Builder" ></a>

<!----------------------------------------------->
<div class="bm40"></div>
<!----------------------------------------------->
</div><!-- end of content -->
<footer id="mainfooter">
<div class="tp10 bm10 bp10 textright"> 
<span class="rm500 font80"><a href="/lib/index1.html">メニューに戻る</a></span>
<span class="rm20 font80"><a href="#mainheader">TOPに戻る</a></span>
</div> 
</footer>
<!-- ↑↑↑↑↑↑↑↑↑↑ -->
<script type="text/javascript" src="/lib/access/access2.js"></script>
</body>
</html>






