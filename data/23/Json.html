<!-- -->
<DOCTYPE HTML>
<html id="mainhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>JSON形式ファイルの操作</title>
	<link rel="stylesheet" type="text/css" href="/lib/document.css">
</head>
<body id="mainbody">
<!-- ↓↓↓↓↓↓↓↓↓↓↓ -->
<script type="text/javascript" src="/lib/funcs1.js"></script>
<!-- ↑↑↑↑↑↑↑↑↑↑ -->
<div id="content">
<h2 class="lm70 tm20 bm0">
JSON形式ファイルの操作
</h2>
<div class="lm70 tm10 rm60">
</div>
<div class="lm70 tm5 rm60">
Objective-Cの配列オブジェクト/辞書オブジェクト及び両者の組み合わせは、JSON形式のテキストに変換することができる。
</div>
<div class="lm70 tm10 rm60">
操作は次の二つである
</div>
<div class="lm70 tm0 rm60">
・JSON形式のテキストを読み込んで配列オブジェクト/辞書オブジェクトに変換する
</div>
<div class="lm70 tm0 rm60">
・配列オブジェクト/辞書オブジェクトをJSON形式のテキストに書き出す
</div>
<div class="lm70 tm20 rm60">
JSON形式のデータ構造
</div>
<div class="lm70 tm5 rm60">
[ value, value, ... ] → 配列（大括弧で囲む）
</div>
<div class="lm70 tm5 rm60">
{ key : value, key : value, ... } → 辞書（中括弧で囲む、キーと値はコロンで区切る）
</div>
<div class="lm70 tm20 rm60">
配列の要素を辞書にすることで、ファイルのレコードやデータベースのテーブルを表すことができる。
</div>
<div class="lm70 tm5 rm60">
[ { key : value, key : value, ... } , 
</div>
<div class="lm70 tm0 rm60">
  { key : value, key : value, ... } , ... ]
</div>
<div class="lm70 tm20 rm60">
要素のデータ型
</div>
<div class="lm70 tm0 rm60">
key および Value のリテラル値はダブルコーテーションで囲む。値はNSStringオブジェクトに変換される。（数値リテラルは内部的にはNSTaggedPointerString型になるが、NSStringとして扱われる）
</div>
<div class="lm70 tm10 rm60">
辞書のkey を数値リテラルで定義したときは注意が必要。作成された辞書オブジェクトのキーはNSString型になるため、NSNumber型の値をキーにしても読み込めない。NSString型への変換が必要となる。
</div>
<h3 class="lm70 tm20 bm5 rm60">
実装方法
</h3>
<div class="lm70 tm10 rm60">
JSONファイルの作成：大相撲関取の情報（オブジェクトの配列とする）
</div>
<!-- ソースコード -->
<iframe class="lm70 tm5" src="/lib/HTMLofText.html?filename=/data/23/sumo.txt" width="580" height="130"></iframe>
<h2 class="lm70 tm20 bm0 rm60">
読み込み処理
</h2>
<h4 class="lm70 tm0 bm0 rm60">
JSON形式のテキストを読み込んでオブジェクト（配列や辞書）に変換する 
</h4>
<!-- 画像 -->
<a href="/lib/HTMLofImage.html?filename=/data/23/JSONSerialization1.png&title=JSONファイルの操作&width=700" target="_new">
<img class="lm130 tm0 " src="JSONSerialization1.png" alt="[JSONファイルの操作]" width="450"></a>
<div class="lm70 tm30 rm60">
UTF-8形式のJSONデータファイルを読み込み辞書の配列を作成する。
</div>
<!-- ソースコード -->
<iframe class="lm70 tm5" src="/lib/HTMLofText.html?filename=/data/23/readJSON.txt" width="580" height="540"></iframe>
<h2 class="lm70 tm30 bm0 rm60">
書き出し処理
</h2>
<h4 class="lm70 tm0 bm0 rm60">
オブジェクト（配列や辞書）をJSON形式のテキストに書き出す
</h4>
<!-- 画像 -->
<a href="/lib/HTMLofImage.html?filename=/data/23/JSONSerialization2.png&title=JSONファイルの操作&width=700" target="_new">
<img class="lm130 tm0 " src="JSONSerialization2.png" alt="[JSONファイルの操作]" width="450"></a>
<div class="lm70 tm30 rm60">
辞書の配列をUTF-8形式のJSONデータファイルへ書き出す
</div>
<!-- ソースコード -->
<iframe class="lm70 tm5" src="/lib/HTMLofText.html?filename=/data/23/writeJSON.txt" width="580" height="250"></iframe>
<h3 class="lm70 tm30 bm0 rm60">
[参考] テキストの文字コード
</h3>
<div class="lm70 tm5 rm60">
JSONオブジェクトを作成するNSJSONSerializationクラスは、入力のNSDataオブジェクトのテキストがUTF-8でエンコードされていることを前提とする。
</div>
<div class="lm70 tm10 rm60">
それ以外の文字コードのテキストを扱う場合は、JSONオブジェクト作成の前後で文字コードをUTF-8に変換する必要がある。
</div>
<div class="lm70 tm10 rm60">
Shift_JIS形式のJSONデータファイルを読み込み辞書の配列を作成する。
</div>
<!-- ソースコードリンク -->
<div class="lm70 tm0">
<a href="/lib/HTMLofText.html?filename=/data/23/source/readJSON2.txt&indent=20" target="_new">コードはこちら</a>
</div>
<div class="lm70 tm10 rm60">
辞書の配列をShift_JIS形式のJSONデータファイルへ書き出す
</div>
<!-- ソースコードリンク -->
<div class="lm70 tm0">
<a href="/lib/HTMLofText.html?filename=/data/23/source/writeJSON2.txt&indent=20" target="_new">コードはこちら</a>
</div>
<div class="bp40"></div>	<!-- 空白行 -->
<!----------------------------------------------->
</div><!-- end of content -->
<!-- ↓↓↓↓↓↓↓↓↓↓↓ -->
<footer id="mainfooter">
<div class="tp10 bm10 bp10 textright"> <span class="rm500 font80"><a href="/lib/index1.html">メニューに戻る</a></span><span class="rm20 font80"><a href="#mainheader">TOPに戻る</a></span></div>
</footer>
<!-- ↑↑↑↑↑↑↑↑↑↑ -->
<script type="text/javascript" src="/lib/access/access2.js"></script>
</body>
</html>



