<!-- 
22 sort
-->
<DOCTYPE HTML>
<html id="mainhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>配列のソート</title>
	<link rel="stylesheet" type="text/css" href="/lib/document.css">
</head>
<body id="mainbody">
<!-- ↓↓↓↓↓↓↓↓↓↓↓ -->
<script type="text/javascript" src="/lib/funcs1.js"></script>
<!-- ↑↑↑↑↑↑↑↑↑↑ -->
<div id="content">
<h2 class="lm100 tm20 bm10">配列のソート</h2>
<!--画像-->
<a href="/lib/HTMLofVideo.html?filename=/data/25/sort.mp4&title=healthCalendar&width=600" target="_new">
<img class="lm100 tm0 bm10" src="sort1.png" width="400" align="top" alt="sort1" ></a>
<div class="lm100 tm10 rm60">
本章では、配列の要素にユーザ定義クラスのオブジェクトを持った配列のソート方法について説明する。
</div>
<h3 class="lm100 tm10 bm0 rm60">
処理パターン
</h3>
<!--ソースコード-->
<iframe class="lm100 tm5 bm5" src="/lib/HTMLofText.html?filename=/data/25/sort_pattern.txt" width="550" height="50"></iframe>
<div class="lm100 tm5 rm60">
配列の要素をソート記述子の指定に従いソートし新しい配列として出力する。
</div>
<div class="lm100 tm10 rm60">
ソート記述子が配列なのは、ソートキーを複数定義するため。要素の設定順はキーの優先順位となる。
</div>
<div class="lm100 tm10 rm60">
ソート記述子（NSSortDescriptorクラス）にはソートキーと昇順/降順を指定する。ソートキーは配列の要素を構成するプロパティ名を文字列で指定する。この方法はKVCに基づく。
</div>
<!--ソースコード-->
<iframe class="lm100 tm5 bm5" src="/lib/HTMLofText.html?filename=/data/25/sort_descriptor.txt" width="550" height="80"></iframe>
<div class="lm100 tm10 rm60">
ソートの対象となるこのプロパティは、大小の比較を行う compareメソッドを実装していることが前提。基本クラスである NSString, NSNumber, NSDate等はデフォルトで実装済み。
</div>
<div class="lm100 tm10 rm60">
ユーザ定義クラスもcompareメソッドを独自に定義すれば、基本クラスと同じように、
オブジェクトをソートキーのプロパティとして指定することができる。
</div>
<div class="lm100 tm10 rm60">
以下、サンプルアプリを元に実装方法を説明する
</div>
<h3 class="lm100 tm20 bm0 rm60">
使用するデータ
</h3>
<div class="lm100 tm0 rm60">
配列の要素はユーザ定義クラスの寿司ネタクラス（Sushi）とする。
</div>
<!--ソースコード-->
<iframe class="lm100 tm5 bm5" src="/lib/HTMLofText.html?filename=/data/25/sushi.txt" width="550" height="160"></iframe>
<div class="lm100 tm10 rm60">
寿司ネタクラスはメンバに売上クラス（Sales）を持つ
</div>
<!--ソースコード-->
<iframe class="lm100 tm5 bm5" src="/lib/HTMLofText.html?filename=/data/25/sales.txt" width="550" height="130"></iframe>
<div class="lm100 tm10 rm60">
配列の作成
</div>
<!--ソースコード-->
<iframe class="lm100 tm5 bm5" src="/lib/HTMLofText.html?filename=/data/25/AppDelegate.txt" width="550" height="590"></iframe>
<h3 class="lm100 tm20 bm0 rm60">
ソート方法
</h3>
<div class="lm100 tm5 rm60">
以下に示したコードをAppControllerに実装し、ボタンで起動すれば、配列が指定のソート方法によりソートされテーブルビューが更新される。
</div>
<h3 class="lm100 tm20 bm0 rm60">
寿司ネタコードでソートする
</h3>
<div class="lm100 tm5 rm60">
ソート記述子による NSNumberの比較
</div>
<!--ソースコード-->
<iframe class="lm100 tm5 bm5" src="/lib/HTMLofText.html?filename=/data/25/sort1.txt" width="550" height="300"></iframe>
<h3 class="lm100 tm20 bm0 rm60">
寿司ネタの名前でソートする
</h3>
<div class="lm100 tm5 rm60">
ソート記述子による NSStringの比較
</div>
<!--ソースコード-->
<iframe class="lm100 tm5 bm5" src="/lib/HTMLofText.html?filename=/data/25/sort2.txt" width="550" height="290"></iframe>
<h3 class="lm100 tm20 bm0 rm60">
寿司ネタの単価ででソートする
</h3>
<div class="lm100 tm5 rm60">
ソート記述子による整数（NSString）の比較
</div>
<!--ソースコード-->
<iframe class="lm100 tm5 bm5" src="/lib/HTMLofText.html?filename=/data/25/sort3.txt" width="550" height="450"></iframe>
<h3 class="lm100 tm20 bm0 rm60">
寿司ネタの売上金額でソートする
</h3>
<div class="lm100 tm5 rm60">
ソート記述子による売上クラス（Sales）の比較
</div>
<div class="lm100 tm10 rm60">
売上金額は、Salesクラスの単価と数量の掛け算の結果となる。Salesクラスに売上金額の大小を比較するcompareメソッドを定義すれば、Sushiクラスのメンバであるsalesプロパティをソートキーに指定すれば売上金額でソートできるようになる。
</div>
<!--ソースコード-->
<iframe class="lm100 tm5 bm5" src="/lib/HTMLofText.html?filename=/data/25/sort4.txt" width="550" height="370"></iframe>
<div class="lm100 tm10 rm60">
売上クラス（Sales）の比較メソッド
</div>
<!--ソースコード-->
<iframe class="lm100 tm5 bm5" src="/lib/HTMLofText.html?filename=/data/25/compare_sales.txt" width="550" height="260"></iframe>
<h3 class="lm100 tm20 bm0 rm60">
Sushiクラスでソートする
</h3>
<div class="lm100 tm5 rm60">
寿司ネタの名前（カナ）をソートキートする。</div>
<div class="lm100 tm0 rm60">
Sushiクラスには、カナの大小を比較する compareメソッドを定義する。ソート記述子のキーに nilを指定するのがポイント。
</div>
<!--ソースコード-->
<iframe class="lm100 tm5 bm5" src="/lib/HTMLofText.html?filename=/data/25/sort5.txt" width="550" height="280"></iframe>
<div class="lm100 tm10 rm60">
寿司ネタクラス（Sushi）の比較メソッド
</div>
<!--ソースコード-->
<iframe class="lm100 tm5 bm5" src="/lib/HTMLofText.html?filename=/data/25/compare_sushi1.txt" width="550" height="130"></iframe>
<h3 class="lm100 tm20 bm0 rm60">
ソート記述子にcompreメソッド名を指定する
</h3>
<div class="lm100 tm5 rm60">
ソート記述子にcompreメソッドを指定する方法
</div>
<div class="lm100 tm0 rm60">
ソート記述子のselector引数にメソッド名を指定する。シグネチャが同じなら”comapare”以外の名前を指定できる。ユーザ定義クラスに複数の比較メソッドを定義するときに利用できる。この場合は、メソッド定義をヘッダファイルに記述し公開する。
</div>
<!--ソースコード-->
<iframe class="lm100 tm5 bm5" src="/lib/HTMLofText.html?filename=/data/25/sort6.txt" width="550" height="320"></iframe>
<div class="lm100 tm10 rm60">
寿司ネタクラス（Sushi）の比較メソッド
</div>
<!--ソースコード-->
<iframe class="lm100 tm5 bm5" src="/lib/HTMLofText.html?filename=/data/25/compare_sushi2.txt" width="550" height="230"></iframe>
<h3 class="lm100 tm20 bm0 rm60">
Cの比較関数を利用する
</h3>
<div class="lm100 tm5 rm60">
あまり使わないと思うが、compareメソッドの代わりに大小比較をC関数に実装することもできる。ソートの実行は、sortedArrayUsingFunctionメソッドを使用する。引数により関数へ任意の情報を渡すことができる。
</div>
<!--ソースコード-->
<iframe class="lm100 tm5 bm5" src="/lib/HTMLofText.html?filename=/data/25/sort7.txt" width="550" height="240"></iframe>
<div class="lm100 tm10 rm60">
寿司ネタクラス（Sushi）をカナで比較するC関数。（どこに実装してもかまわないが、Sushiクラスのファイルに実装してみた）
</div>
<!--ソースコード-->
<iframe class="lm100 tm5 bm5" src="/lib/HTMLofText.html?filename=/data/25/compare_sushi_c.txt" width="550" height="300"></iframe>

<h4 class="lm100 tm30 bm0 rm60">
テーブルビューの列見出しをクリックしたときにソートする
</h4>
<div class="lm100 tm0 rm60">
<a href='/data/73/array_controller.html' target="_new">こちらを参照</a>
</div>

<div class="bm40"></div>
</div><!-- end of content -->
<!-- ↓↓↓↓↓↓↓↓↓↓↓ -->
<footer id="mainfooter">
<div class="tp10 bm10 bp10 textright"> 
<span class="rm500 font80"><a href="/lib/index1.html">メニューに戻る</a></span>
<span class="rm20 font80"><a href="#mainheader">TOPに戻る</a></span>
</div> 
</footer>
<!-- ↑↑↑↑↑↑↑↑↑↑ -->
<script type="text/javascript" src="/lib/access/access2.js"></script>
</body>
</html>





