<!-- 
95 Category
-->
<DOCTYPE HTML>
<html id="mainhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>カテゴリによる機能拡張</title>
	<link rel="stylesheet" type="text/css" href="/lib/document.css">
</head>
<body id="mainbody">
<!-- ↓↓↓↓↓↓↓↓↓↓↓ -->
<script type="text/javascript" src="/lib/funcs1.js"></script>
<!-- ↑↑↑↑↑↑↑↑↑↑ -->
<div id="content">
<h2 class="lm70 tm20 bm10">カテゴリによる機能拡張</h2>
<div class="lm100 tm0 rm60">
</div>
<div class="lm100 tm5 rm60">
カテゴリの目的のひとつは、アプリケーションの開発/保守を容易にするために、大きなクラスを分割することにある。ただし分割したクラスにはメソッドの追加のみ可能で、インスタンス変数を定義することはできない。
</div>
<div class="lm100 tm10 rm60">
この機能を利用して、既存の基本クラスに、ユーザが開発した独自のメソッドを追加することができる。
</div>
<div class="lm100 tm10 rm60">
フレームワークのクラスに独自メソッドを追加するにはサブクラス化が一般的な方法だが、Objective-C では、インスタンス変数を追加する必要がないという条件はあるが「カテゴリ」を利用してメソッドの追加が簡単に行える。
</div>
<div class="lm100 tm10 rm60">
例えば、NSStringクラスに、オブジェクトが保持してる文字列の順番を反転して返すインスタンスメソッドを追加してみる。名前は"reverse"とする。以下にメソッドの使用例を示す。
</div>
<!--ソースコード-->
<iframe class="lm100 tm5" src="/lib/HTMLofText.html?filename=/data/08/useMyString.txt" width="550" height="130"></iframe>	
<!----------------------------------------------------------------------------->
<h3 class="lm100 tm20 bm5 rm60">
カテゴリによるメソッドの追加方法
</h3>	
<div class="lm100 tm10 rm60">
クラスを分割するときは、ヘッダファイル/実装ファイルそれぞれを作成し、メソッドの宣言と実装を記述する。クラス名は、ベースとなるクラス名に、"(カテゴリ名)"を追加する。ソースファイル名は、"クラス名+カテゴリ名" とするのが一般的。カテゴリ名はどこからか参照されるものでないので、システムで一意（ベースのクラスの中でカテゴリ名が重ならない）であれば、何でも構わない。
</div>
<div class="lm100 tm10 rm60">
ヘッダファイル（NSString+MyString.h）
</div>
<!--ソースコード-->
<iframe class="lm100 tm5" src="/lib/HTMLofText.html?filename=/data/08/MyString1.txt" width="550" height="90"></iframe>		
<div class="lm100 tm10 rm60">
実装ファイル(NSString+MyString.m)
</div>
<!--ソースコード-->
<iframe class="lm100 tm5" src="/lib/HTMLofText.html?filename=/data/08/MyString2.txt" width="550" height="280"></iframe>		
<h3 class="lm100 tm20 rm60 bm0">
NSObjectクラスのカテゴリ
</h3>		
<div class="lm100 tm5 rm60">
NSObjectクラスは全てのクラスの親クラスなので、NSObjectのカテゴリを作成してここにメソッドを追加すれば、あらゆるオブジェクトから呼び出すことができる。
</div>
<div class="lm100 tm10 rm60">
例として、自身のオブジェクトのクラス名を、NSObjectまで遡って取得し、テキストに出力する whoメソッドを追加する。
</div>
<div class="lm100 tm10 rm60">
ヘッダファイル（NSObject+who.h）
</div>
<!--ソースコード-->
<iframe class="lm100 tm5" src="/lib/HTMLofText.html?filename=/data/08/MyObject1.txt" width="550" height="130"></iframe>
<div class="lm100 tm10 rm60">
実装ファイル(NSObject+who.m)
</div>
<!--ソースコード-->
<iframe class="lm100 tm5" src="/lib/HTMLofText.html?filename=/data/08/MyObject2.txt" width="550" height="480"></iframe>
<div class="lm100 tm20 rm60">
使用方法
</div>		
<div class="lm100 tm0 rm60">
NSTextFieldクラスのオブジェクトのクラス名を求める。
</div>		
<!--ソースコード-->
<iframe class="lm100 tm5" src="/lib/HTMLofText.html?filename=/data/08/useMyObject.txt" width="550" height="90"></iframe>
<div class="lm90 tm20 rm60">
（備忘録）
</div>
<div class="lm100 tm0 rm60">
宣言ファイルをインポートしなくても、そこに定義されたメソッドが呼ばれる場合がある。どのような仕掛けになっているのか不明
</div>
<div class="lm100 tm0 rm60">
カテゴリで追加したメソッド名同士が重複したり、ベースとなるクラスの基本メソッド名と重複してはならない。コンパイルエラーにはならないが、実行時どれかしらのメソッドが呼ばれて、予期せぬエラーになる。
</div>
<div class="bm40"></div>
</div><!-- end of content -->
<!-- ↓↓↓↓↓↓↓↓↓↓↓ -->
<footer id="mainfooter">
<div class="tp10 bm10 bp10 textright"> 
<span class="rm500 font80"><a href="/lib/index1.html">メニューに戻る</a></span>
<span class="rm20 font80"><a href="#mainheader">TOPに戻る</a></span>
</div> 
</footer>
<!-- ↑↑↑↑↑↑↑↑↑↑ -->
<script type="text/javascript" src="/lib/access/access2.js"></script>
</body>
</html>





