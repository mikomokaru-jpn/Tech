<!-- -->
<DOCTYPE HTML>
<html id="mainhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>ウィンドウ制御の仕組み</title>
	<link rel="stylesheet" type="text/css" href="../document.css">
</head>
<body id="mainbody">
<!-- ↓↓↓↓↓↓↓↓↓↓↓ -->
<script type='text/javascript' src='/lib/funcs1.js'></script>
<!-- ↑↑↑↑↑↑↑↑↑↑ -->
<div id="content">
<h2 class="lm70 tm20 bm10">ウィンドウ制御の仕組み</h2>
<div class="lm100 tm5 bm5 rm60">
ウィンドウコントローラーは、ウィンドウとウィンドウが保持するオブジェクトの振る舞いを制御する。ウィンドウコントローラの機能は、NSwindowConreollerのサブクラスに実装されるだけでなく、それ以外のクラスにも実装される。AppDelegateクラスがウィンドウコントローラーとして機能することが多いのは典型的な例である。この章では両者ついて説明する。    
</div>
<h3 class="lm100 tm20 rm60 bm0">
AppDeelegateクラスをウィンドウコントローラとする
</h3>
<div class="lm100 tm5 rm60">
Xcodeでウィンドウアプリケーション（Cocpa App）を作成すると、自動的にAppDeelegateクラスが作成され、空白のウィンドウオブジェクトがxibファイルに生成される。デフォルトの仕組みでは、アプリケーション起動後にウィンドウオブジェクトが xibファイルから自動的に読み込まれてウィンドウが開く。
</div>
<div class="lm100 tm10 rm60">
以下の簡単な例で実装方法を説明する。 アプリケーションはボタンがクリックされたときに「ボタンがクリックされた」の文字列をテキストフィールドに入力し、ボタンの機能を無効にする。
</div>

<!-- 画像 -->
<a href="../HTMLofImage.php?filename=43/43_win_apl.png&title=サンプルアプリケーション&width=750" target="_new">
<img class="lm100 tm10" src="43_win_apl.png" width="400" align="top" alt="サンプルアプリケーション" ></a>
<!-- 画像 -->
<a href="../HTMLofImage.php?filename=43/43_win_ctrl1.png&title=ウィンドウ制御&width=750" target="_new">
<img class="lm100 tm5" src="43_win_ctrl1.png" width="400" align="top" alt="ウィンドウ制御" ></a>
<h4 class="lm100 tm20 bm0 rm60 bm5">
インタフェースビルダ
</h4>
<div class="lm100 tm5 rm60">
ウィンドウ上にテキストフィールドとボタンのオブジェクトを配置する。これらはNSControlのサブクラスであるため、以下で説明する機能を実装することができる。
</div>
<div class="lm100 tm10 rm60">
AppDelegateクラスから、テキストフィールドとボタンに対しアウトレット接続をする。これにより、AppDelegateクラスのコードからこれらのオブジェクトのプロパティに対し参照や操作が可能となる。
</div>
<div class="lm100 tm10 rm60">
ボタンからAppDelegateクラスのメソッドに対しアクション接続をする。 これでボタンのクリックにより、このメソッドを呼び出すことができる。
</div>

<!-- 画像 -->
<a href="../HTMLofImage.php?filename=43/43_win_IB.png&title=インタフェースビルダ&width=750" target="_new">
<img class="lm100 tm5" src="43_win_IB.png" width="550" align="top" alt="インタフェースビルダ" ></a>
<h4 class="lm100 tm20 rm60 bm5">
Xcode
</h4>
<div class="lm100 tm5 rm60">
テキストフィールドへのアウトレット接続を通して初期値の文字列をセットする。ボタンがクリックされたらテキストフィールドの値を更新し、ボタンの機能を無効化する処理をアクションメソッドに実装する。
</div>
<!--ソースコード-->
<iframe class="lm100 tm5" src="../HTMLofText.php?filename=43/source/AppDelegate.txt" width="530" height="320"></iframe>
<h3 class="lm100 tm40 rm60 bm0">
NSWindowControllerクラスをウィンドウコントローラとする
</h3>
<div class="lm100 tm5 rm60">
次の例はメインウィンドウからサブウィンドウを開く処理である。このような場合、NSWindowControllerクラスのサブクラスを作成し、サブウィンドウの制御を担当させるのが一般的である。
</div>
<div class="lm100 tm5 rm60">
ウィンドウコントローラはサブウィンドウが保持するコントロール（テキストフィールド、ボタンなど）を制御する処理を実装し、それらをxibファイル内のウィンドウオブジェクトと関連付ける。
</div>
<!-- 画像 -->
<a href="../HTMLofImage.php?filename=43/43_win_apl2.png&title=サンプルアプリケーション&width=800" target="_new">
<img class="lm100 tm10" src="43_win_apl2.png" width="500" align="top" alt="サンプルアプリケーション" ></a>
<!-- 画像 -->
<a href="../HTMLofImage.php?filename=43/43_win_ctrl4.png&title=ウィンドウ制御&width=800" target="_new">
<img class="lm90 tm10 bm10" src="43_win_ctrl4.png" width="450" align="top" alt="ウィンドウ制御" ></a>
<h4 class="lm100 tm10 rm60 bm5">
インタフェースビルダ
</h4>
<div class="lm100 tm5 rm60">
Xcodeで空白のウィンドウを持ったユーザーインターフェイス（xibファイル）を新規作成する。 インタフェースビルダーを使用し、ウィンドウにテキストフィールドとボタンのオブジェクトを追加する。
</div>
<div class="lm100 tm10 rm60">
xibファイルのFile's OwnerのクラスをNSWindowControllerクラスのサブクラスにする。これによりウィンドウ、テキストフィールド、ボタンなどをウィンドウコントローラーの所定のプロパティやメソッドに接続できる。アウトレット接続とアクション接続の方法は、AppDelegateの実装と同じ。
</div>
<!-- 画像 -->
<a href="../HTMLofImage.php?filename=43/43_win_IB2.png&title=インタフェースビルダ&width=800" target="_new">
<img class="lm90 tm10" src="43_win_IB2.png" width="530" align="top" alt="インタフェースビルダ" ></a>
<h4 class="lm100 tm20 rm60 bm5">
Xcode
</h4>
<h4 class="lm100 tm5 bm0 rm60">
AppDelegateクラスの実装
</h4>
<div class="lm100 tm5 rm60">
アプリケーション起動時、サブウィンドウのコントローラーオブジェクトを作成し、xibファイルからウィンドウをロードする。ウィンドウは、アプリケーションの実行中はメモリに常駐する。ボタンをクリックするとサブウィンドウが表示される。
</div>
<!--ソースコード-->
<iframe class="lm100 tm5" src="../HTMLofText.php?filename=43/source/AppDelegate2.txt" width="530" height="280"></iframe>

<h4 class="lm100 tm20 bm0 rm60">
ウィンドウ コントローラ クラスの実装
</h4>
<div class="lm100 tm0 rm60">
プログラムの実装はAppDelegateと同じ。
</div>
<!--ソースコード-->
<iframe class="lm100 tm5" src="../HTMLofText.php?filename=43/source/SubWindowController.txt" width="530" height="440"></iframe>
<div class="lm100 tm10 rm60">
サブウィンドウを開く詳しい方法は、<a href='../03/open_subwindow.php' target="new">「メインウィンドウからサブウィンドウを開く」</a>を参照。
</div>
<h3 class="lm70 tm30 rm60 bm0">
プログラムでウィンドウをデザインする
</h3>
<div class="lm100 tm5 rm60">
インターフェイスビルダーの代わりにプログラムでコントロール（テキストフィールド、ボタンなど）を作成する方法
</div>
<!-- 画像 -->
<a href="../HTMLofImage.php?filename=43/43_win_ctrl3.png&title=ウィンドウ制御&width=800" target="_new">
<img class="lm90 tm10 bm10" src="43_win_ctrl3.png" width="450" align="top" alt="ウィンドウ制御" ></a>
<h4 class="lm100 tm10 rm60 bm5">
インタフェースビルダ
</h4>
<div class="lm100 tm5 rm60">
空白のウィンドウを持ったユーザーインターフェイス（xibファイル）を作成する。    
</div>
<h4 class="lm100 tm10 rm60 bm5">
Xcode
</h4>
<div class="lm100 tm5 rm60">
ウィンドウコントローラは、ウィンドウロード時にテキストフィールドとボタンのオブジェクトを作成し、コンテントビューに貼り付ける。また、それらのオブジェクトをプロパティとして保持する。オブジェクトへの参照を通してテキストフィールドに文字列を設定する。ボタンの独自のアクションを定義し、クリックされたとき呼び出されるメソッドの実装を行う。
</div>
<!--ソースコード-->
<iframe class="lm100 tm10" src="../HTMLofText.php?filename=43/source/TestWindowController2.txt" width="530" height="410"></iframe>


<!----------------------------------------------->
<div class="bm40"></div>
<!----------------------------------------------->
</div><!-- end of content -->
<footer id="mainfooter">
<div class="tp10 bm10 bp10 textright"> <span class="rm500 font80"><a href="../index1.php">メニューに戻る</a></span><span class="rm20 font80"><a href="#mainheader">TOPに戻る</a></span></div>
</footer>
<!-- ↑↑↑↑↑↑↑↑↑↑ -->
<script type="text/javascript" src="../access/access2.js"></script>
</body>
</html>






