#import <Cocoa/Cocoa.h>@interface AppDelegate : NSObject <NSApplicationDelegate>@end#import "AppDelegate.h"@interface AppDelegate ()@property (weak) IBOutlet NSTextField *outField;    //右側のテキストフィールド@property NSInteger counter;                        //カウンタ：監視するプロパティ@end@implementation AppDelegate- (void)applicationDidFinishLaunching:(NSNotification *)aNotification {    _counter = 0;    //プロパティの監視の開始    [self addObserver:self forKeyPath:@"counter"              options:NSKeyValueObservingOptionNew|NSKeyValueObservingOptionOld              context:nil];    //１秒間隔でカウンタをインクリメントする    NSTimer *timer =[NSTimer                     scheduledTimerWithTimeInterval:1.0f                     target:self                     selector:@selector(compute:)                     userInfo:nil                     repeats:YES];    [timer fire];}//カウンタのインクリメント-(void)compute:(NSTimer*)tm{    if (_counter > 99){        _counter = 0;   //100で戻る    }    //テキストフィールド（右）は、プロパティ counter をバインドしている。    //カウンタの値の変化がテキストフィールドに即反映される。    [self willChangeValueForKey:@"counter"];    _counter++;    [self didChangeValueForKey:@"counter"];}//プロパティ counter が変更されたときのコールバック処理- (void)observeValueForKeyPath:(NSString *)keyPath                      ofObject:(id)object                        change:(NSDictionary *)change                       context:(void *)context{    if ([keyPath isEqual:@"counter"]) {        //プロパティの名前を判定する。        //変更前後の値をテキストフィールド（左）に出力する。        _outField.stringValue =        [NSString stringWithFormat:@"%@ → %@", change[@"old"], change[@"new"]];    }}@end