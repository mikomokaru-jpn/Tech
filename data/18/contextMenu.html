<!-- 
19 DragDrop
-->
<DOCTYPE HTML>
<html id="mainhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>コンテキストメニューを表示する</title>
	<link rel="stylesheet" type="text/css" href="/lib/document.css">
</head>
<body id="mainbody">
<!-- ↓↓↓↓↓↓↓↓↓↓↓ -->
<script type="text/javascript" src="/lib/funcs1.js"></script>
<!-- ↑↑↑↑↑↑↑↑↑↑ -->
<div id="content">
<h2 class="lm90 tm10 bm10">コンテキストメニューを表示する</h2>
<!-- 画像 -->
<div class="lm100 tm10 rm60 bm0">
ビューの上でマウスを右クリックしてコンテキストメニューを表示する。メニューをクリックすると対応するメソッドが起動する。
</div>
<a href="/lib/HTMLofImage.html?filename=/data/18/contextMenu.png&title=コンテキストメニュー&width=900" target="_new">
<img class="lm130 tm10 bm0" src="contextMenu.png" width="250" align="top" alt="コンテキストメニュー" ></a>
<h4 class="lm100 tm15 rm60 bm0">
Interface Builder
</h4>
<h3 class="lm120 tm5 rm60 bm0">
1. メニューの作成
</h3>
<div class="lm130 tm5 rm60 bm0">
コンテキストメニューを作成し、ビューと接続する。
</div>
<div class="lm130 tm10 rm60 bm0">
MainMenu.xibをインタフェースビルダーで開き、オブジェクトライブラリからメニュー（NSMenuクラス）を選択し、エディタエリアの余白に追加する。
</div>
<div class="lm130 tm10 rm60 bm0">
メニューを表示するビューの上にカーソルを合わせ、右クリックでビューのOutlet一覧を表示する。menuプロパティをメニューオブジェクトまでドラッグして両者を接続する。
</div>
<!-- 画像 -->
<a href="/lib/HTMLofImage.html?filename=1/data/18/contextmenu01.png&title=Interface　Builder1&width=900" target="_new">
<img class="lm120 tm5 bm0" src="contextmenu01.png" width="400" align="top" alt="contextmenu01" ></a>
<div class="lm130 tm10 rm60 bm0">
これにより、ビューはコンテキストメニューを表示しイベントの受付けたり、メニューに対する操作が可能となる。
</div>
<div class="lm130 tm10 rm60 bm0">
なお、プログラムからメニュー要素の有効/無効を可能にするには、メニューの属性「Auto Enables Items」をオフにする。
</div>
<h3 class="lm120 tm20 rm60 bm0">
2. メニュー要素の定義
</h3>
<div class="lm130 tm0 rm60 bm0">
メニューにメニュー要素（NSMenuItemクラス）を追加し、名前をつけ、必要ならショートカットキーを定義する。
</div>
<!-- 画像 -->
<a href="/lib/HTMLofImage.html?filename=/data/18/contextmenu02.png&title=Interface　Builder2&width=900" target="_new">
<img class="lm120 tm10 bm0" src="contextmenu02.png" width="400" align="top" alt="contextmenu02" ></a>
<div class="lm130 tm10 rm60 bm0">
初期状態では、メニューオブジェクトには３個の要素が定義されている。要素を削除するときは、要素を選択してdeleteキーを実行。要素を追加するときは、object LiblaryからMenu Itemオブジェクトを選択し、メニューオブジェクトの追加したい位置にドラッグする。
</div>
<div class="lm130 tm10 rm60 bm0">
メニューの要素としてメニューを追加するときは、Submenu Menu Itemオブジェクトを追加する。これでメニューを階層化することができる。
</div>
<h3 class="lm120 tm20 rm60 bm0">
3. アクションの接続
</h3>
<div class="lm130 tm0 rm60 bm0">
メニューのアクションをアクションを実装しているクラスに接続する。
</div>
<div class="lm130 tm10 rm60 bm0">
例では、"copy", "paste"メニューを定義し、メニュー対応するメソッドをAppDelegateクラスに実装する。インタフェースビルダのメニューオブジェクトのcopyメニューから、AppDelegateクラスのcopy:メソッドに対して右クリックのドラッグ（アクション接続）を行う。
</div>
<!-- 画像 -->
<a href="/lib/HTMLofImage.html?filename=/data/18/contextmenu03.png&title=Interface　Builder2&width=900" target="_new">
<img class="lm130 tm10 bm0" src="contextmenu03.png" width="400" align="top" alt="contextmenu03" ></a>
<div class="lm130 tm20 rm60 bm0">
AppDelegateクラス（Xcode）
</div>
<!-- ソースコード -->
<iframe class="lm130 tm5 bm10" src="/lib/HTMLofText.html?filename=/data/18/action.txt" width="520" height="130"></iframe>
<div class="lm130 tm5 rm60 bm0">
以上で、コンテキストメニューの実装は完了。コンテキストメニューを選ぶと対応するメソッドが実行される。
</div>
<h4 class="lm100 tm20 rm60 bm0">
補足
</h4>
<h3 class="lm130 tm0 rm60 bm0">
メニュー要素の有効/無効
</h3>
<div class="lm130 tm5 rm60 bm0">
アクションメソッドが実装され接続された時点でメニュー項目は有効（選択可能）となる。それまでは無効（グレーアウト）である。
</div>
<h3 class="lm130 tm20 rm60 bm0">
メインメニューのデフォルトの動作
</h3>
<div class="lm130 tm5 rm60 bm0">
メインメニューは、アプリケーションを起動したときディスプレイの上部に表示されるメニューバーのこと。ウィンドウアプリケーションを作成するとデフォルトでメインメニューが作成される。"File", "Edit", "Format" など。
</div>
<a href="/lib/HTMLofImage.html?filename=/data/18/MainMenu.png&title=コンテキストメニュー&width=600" target="_new">
<img class="lm130 tm20 bm0" src="MainMenu.png" width="250" align="top" alt="MainMenu" ></a>
<div class="lm130 tm20 rm60 bm0">
アクションのデフォルトの接続先はファーストレスポンダである。例題のケースで、メインメニューのEdit→copyを実行すると、レスポンダーチェーンの探索の結果、AppDdelegateクラスに実装（オーバーライド）されたcopyメソッドが見つかるので、それが実行される。
</div>
<!----------------------------------------------->
<div class="bm40"></div>
<!----------------------------------------------->
</div><!-- end of content -->
<footer id="mainfooter">
<div class="tp10 bm10 bp10 textright"> 
<span class="rm500 font80"><a href="/lib/index1.html">メニューに戻る</a></span>
<span class="rm20 font80"><a href="#mainheader">TOPに戻る</a></span>
</div> 
</footer>
<!-- ↑↑↑↑↑↑↑↑↑↑ -->
<script type="text/javascript" src="/lib/access/access2.js"></script>
</body>
</html>
